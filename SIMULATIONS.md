# Reproduction of large eddy simulation results

The large eddy simulation (LES) data is generated by [Oceananigans.jl](https://github.com/climate-machine/Oceananigans.jl).

To reproduce all the publication's LES data (on a Unix-like system), first:

1. Install [Julia](https://julialang.org).

2. Clone this repository and change into its directory: 

```
git clone https://github.com/glwagner/WaveTransmittedTurbulence.git; cd WaveTransmittedTurbulence
```

3. Instantiate the environment: 

```
julia --project -e 'using Pkg; Pkg.instantiate()'
```

You are now ready to run LES. If you have a nVidia GPU and a working installing of CUDA, the LES will run on the GPU.

# Section 3: turbulence and near-inertial motion forced by growing surface waves

The LES reported in section 3 are initialized from a spinup simulation.

## Spin up

To run the spinup simulation, find a computer with high-powered GPU, complete the 3 steps above, and then type

```
julia --project simulations/run_free_convection.jl --buoyancy_flux 1e-9 --buoyancy_gradient 1e-6 --Nh 256 --Nz 256
```

## Turbulence forced by growing waves

The principal results of section 3 are the forcing of turbulence and near-inertial waves by a growing 
surface wave field. Two simulations are reported: the 4-hour growth of a 1 meter amplitude wave field,
and the 4-hour growth of a 2 meter amplitude wave field. To run both of these LES, type

```
julia --project simulations/run_growing_wave_forced.jl  --wave_amplitude 1 --case growing_waves
```

and

```
julia --project simulations/run_growing_wave_forced.jl  --wave_amplitude 1 --case growing_waves
```

## Turbulence forced by surface stress

It's useful to compare turbulent mixing forced by surface gravity waves, which have an extended vertical profile,
to turbulent mixing forced by stress at the surface. To run the LES forced by surface stress with no waves, type

```
julia --project simulations/run_growing_wave_forced.jl  --wave_amplitude 1 --case surface_stress_no_waves
```

and

```
julia --project simulations/run_growing_wave_forced.jl  --wave_amplitude 2 --case surface_stress_no_waves
```

## Turbulence forced by surface stress beneath steady waves

It's well known that the presence of waves affects turbulent mixing. In the LES beneath growing waves, the momentum 
transmitted by the growing wave field is affected by the presence of the waves themselves. To disentangle the 
catalytic effects of _steady_ surface waves from the more mundane momentum transmission by _growing_ waves,
we run LES of turbulence surface by surface stress with *steady* waves overhead. To run these LES, type

```
julia --project simulations/run_growing_wave_forced.jl  --wave_amplitude 1 --case surface_stress_steady_waves
```

and

```
julia --project simulations/run_growing_wave_forced.jl  --wave_amplitude 2 --case surface_stress_steady_waves
```

# Section 4: effect of 'resting' versus 'excited' initial conditions on LES results
 
## Control

```
julia --project simulations/run_initial_conditions_study.jl --Nh 256 --Nz 256 --initial_condition resting --wave_multiplier 0
```

## Excited, 1x waves

Run the 'excited, 1x' LES forced by wind stress with steady waves and 'excited' initial conditions. This LES reproduces results from McWilliams et al., "Langmuir turbulence in the ocean," JFM (1997):

```
julia --project simulations/run_initial_conditions_study.jl --Nh 256 --Nz 256 --initial_condition resting --wave_multiplier 1
```

## Resting, 1x waves

```
julia --project simulations/run_initial_conditions_study.jl --Nh 256 --Nz 256 --initial_condition excited --wave_multiplier 1
```

## Excited, 4x waves

```
julia --project simulations/run_initial_conditions_study.jl --Nh 256 --Nz 256 --initial_condition resting --wave_multiplier 4
```

## Resting, 4x waves

```
julia --project simulations/run_initial_conditions_study.jl --Nh 256 --Nz 256 --initial_condition excited --wave_multiplier 4
```
